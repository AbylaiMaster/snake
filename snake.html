<html>

<body>

<div id='field'> </div>
<button id='left'> Влево </button>
<button id='right'> Вправо </button>
<button id='up'> Вверх </button>
<button id='down'> Вниз </button>
<p id='score'> </p> 

</body>

<style>

.cell{
	border: 1px solid black;
	background-color: cyan;
}
button{
	width: 100px;
	height: 100px;
}
#score{
	color: red;
	font-size: 300px;
	position: absolute;
	left: 1000px;
	bottom: 300px;
}
</style>

<script>

let field = document.querySelector('#field');
let snake = [{'x' : 0, 'y' : 0}, {'x' : 0, 'y' : 1}, {'x' : 0, 'y' : 2}];
let left = document.querySelector('#left');
let right = document.querySelector('#right');
let up = document.querySelector('#up');
let down = document.querySelector('#down');
let axis = 0;
let score = document.querySelector('#score');
score.innerHTML = 3;
let flag;
let rX;
let rY;
let size = 10;


document.addEventListener("keypress", function(event) {
	if(event.keyCode == 119){
		turnUp();
	}
	else if(event.keyCode == 97){
		turnLeft();
	}
	else if(event.keyCode == 115){
		turnDown();
	}
	else if(event.keyCode == 100){
		turnRight();
	}
});




for(let l = 0; l < size; l++)
{
	let outterDiv = document.createElement('div');
	outterDiv.style.display = 'flex';
	for(let c = 0; c < size; c++)
	{
		let cell = document.createElement('div');
		cell.className = 'cell';
		cell.id = 'c' + l.toString() + 'l' + c.toString();
		cell.style.width = 800/size;
		cell.style.height = 800/size;
		outterDiv.appendChild(cell);

	}
	field.appendChild(outterDiv);
}
left.addEventListener('click', turnLeft);
right.addEventListener('click', turnRight);
up.addEventListener('click', turnUp);
down.addEventListener('click', turnDown);
setInterval(movement, 300);
for(let j = 0; j < snake.length; j++){
	
}
do{
	rX = randomAxis();
	rY = randomAxis();
	flag = false;
	for(let k = 0; k < snake.length; k++){
		if((snake[k].x == rX)&&(snake[k].y == rY)){
			flag = true;
			break;
		}
	}
}while(flag);
let aId = '#c' + rX + 'l' + rY;
document.querySelector(aId).style.backgroundColor = 'green';
function movement(){
	let point;
	let sId;
	switch (axis){
		case 0:
			sId = '#c' + (snake[snake.length-1].x) + 'l' +(snake[snake.length-1].y+1);
			point = {"x" : snake[snake.length-1].x, "y" : snake[snake.length-1].y + 1};
			break;
		case 1:
			sId = '#c' + (snake[snake.length-1].x+1) + 'l' +(snake[snake.length-1].y);
			point = {"x" : snake[snake.length-1].x+1, "y" : snake[snake.length-1].y};
			break;
		case 2:
			sId = '#c' + (snake[snake.length-1].x) + 'l' +(snake[snake.length-1].y-1);
			point = {"x" : snake[snake.length-1].x, "y" : snake[snake.length-1].y - 1};
			break;
		case 3:
			sId = '#c' + (snake[snake.length-1].x-1) + 'l' +(snake[snake.length-1].y);
			point = {"x" : snake[snake.length-1].x-1, "y" : snake[snake.length-1].y};
			break;
	}
	if((snake[snake.length-1].x>=size)||(snake[snake.length-1].y>=size)||(snake[snake.length-1].x<0)||(snake[snake.length-1].y<0)){
		alert("Game over");
		snake = [{'x' : 0, 'y' : 0}, {'x' : 0, 'y' : 1}, {'x' : 0, 'y' : 2}];
		axis = 0;
		for(let l = 0; l<size;l++){
				for(let m = 0; m<size;m++)
				{
					let nId = '#c' + l + 'l' + m;
					document.querySelector(aId).style.backgroundColor = 'cyan';
				}
			}
		return;
	}
	let lId = '#c' + snake[0].x + 'l' +snake[0].y;
	snake.push(point);
	let hId = '#c' + snake[snake.length-2].x + 'l' +snake[snake.length-2].y;
	document.querySelector(lId).style.backgroundColor = 'cyan';
	document.querySelector(hId).style.backgroundColor = 'red';
	document.querySelector(sId).style.backgroundColor = 'orange';
	if(((snake[snake.length-1].x == rX)&&(snake[snake.length-1].y == rY))== false){
		snake.shift();
	}
	else
	{
		do{
			rX = randomAxis();
			rY = randomAxis();
			flag = false;
			for(let k = 0; k < snake.length; k++){
				if((snake[k].x == rX)&&(snake[k].y == rY)){
				flag = true;
				break;
			}
		}
	}while(flag);
	score.innerHTML++;
	let aId = '#c' + rX + 'l' + rY;
	document.querySelector(aId).style.backgroundColor = 'green';
	}
	for(let i = 0; i < snake.length - 1; i++){
		if((snake[snake.length-1].x == snake[i].x)&&(snake[snake.length-1].y == snake[i].y)){
			alert("Game over");
			snake = [{'x' : 0, 'y' : 0}, {'x' : 0, 'y' : 1}, {'x' : 0, 'y' : 2}];
			axis = 0;
			for(let l = 0; l<size;l++){
				for(let m = 0; m<size;m++)
				{
					let nId = '#c' + l + 'l' + m;
					document.querySelector(aId).style.backgroundColor = 'cyan';
				}
			}
			return;
		}
	}
}
function turnLeft(){
	if(axis!=0){
		axis = 2;
	}
}
function turnRight(){
	if(axis!=2){
	axis = 0;
	}
}
function turnUp(){
	if(axis!=1){
	axis = 3;
	}
}
function turnDown(){
	if(axis!=3){
	axis = 1;
	}
}
function randomAxis(){
  return Math.floor(Math.random() * size);
}
</script>

</html>
